{% extends 'base.html' %}

{% block content %}
{% set can_edit = session.get('can_edit', 1) %}

<div class="app-card">
  <div class="app-card-header d-flex justify-content-between align-items-center py-3 px-3 rounded-top">
    <h6 class="mb-0 text-body">Matieres</h6>
  </div>

  <div class="card-body p-3">
    {% if not can_edit %}
    <div class="alert alert-warning py-2">Mode lecture seule: gestion des matieres desactivee.</div>
    {% endif %}

    {% if can_edit %}
    <form method="post" class="d-flex gap-2 mb-3">
      {{ csrf_field() }}
      <input type="text" name="name" class="form-control form-control-sm" placeholder="Nouvelle matiere">
      <button class="btn btn-success btn-sm">Ajouter</button>
    </form>
    {% endif %}

    <div class="table-responsive">
      <table class="table table-sm mb-0 align-middle">
        <thead>
          <tr>
            <th>Nom</th>
            <th style="width: 120px;"></th>
          </tr>
        </thead>
        <tbody>
          {% for s in subjects %}
          <tr>
            <td>{{ s.name }}</td>
            <td class="text-end">
              {% if can_edit %}
              <form action="/subjects/delete/{{ s.id }}" method="post">
                {{ csrf_field() }}
                <button class="btn btn-sm btn-outline-danger" onclick="return confirm('Supprimer cette matiere ?')">Supprimer</button>
              </form>
              {% endif %}
            </td>
          </tr>
          {% else %}
          <tr>
            <td colspan="2" class="text-center text-muted py-3">Aucune matiere</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
